{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":211},"executionInfo":{"elapsed":60,"status":"error","timestamp":1762260172393,"user":{"displayName":"bakhoya","userId":"02952077666305694402"},"user_tz":-180},"id":"Dn-H0EGgavA8","outputId":"ad8e4224-0940-4d33-b126-6708221c745a"},"outputs":[{"output_type":"error","ename":"NameError","evalue":"name 'streamlit' is not defined","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m/tmp/ipython-input-2097502396.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mstreamlit\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mpandas\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mnumpy\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0mplotly\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mpydeck\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'streamlit' is not defined"]}],"source":["streamlit\n","pandas\n","numpy\n","plotly\n","pydeck\n","joblib\n","matplotlib\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9356,"status":"ok","timestamp":1762152417402,"user":{"displayName":"bakhoya","userId":"02952077666305694402"},"user_tz":-180},"id":"f7d77260","outputId":"d50682b0-5f4e-4ace-ff87-ffc05a888282"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting streamlit\n","  Downloading streamlit-1.51.0-py3-none-any.whl.metadata (9.5 kB)\n","Collecting pydeck\n","  Downloading pydeck-0.9.1-py2.py3-none-any.whl.metadata (4.1 kB)\n","Requirement already satisfied: altair!=5.4.0,!=5.4.1,<6,>=4.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (5.5.0)\n","Requirement already satisfied: blinker<2,>=1.5.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (1.9.0)\n","Requirement already satisfied: cachetools<7,>=4.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (5.5.2)\n","Requirement already satisfied: click<9,>=7.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (8.3.0)\n","Requirement already satisfied: numpy<3,>=1.23 in /usr/local/lib/python3.12/dist-packages (from streamlit) (2.0.2)\n","Requirement already satisfied: packaging<26,>=20 in /usr/local/lib/python3.12/dist-packages (from streamlit) (25.0)\n","Requirement already satisfied: pandas<3,>=1.4.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (2.2.2)\n","Requirement already satisfied: pillow<13,>=7.1.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (11.3.0)\n","Requirement already satisfied: protobuf<7,>=3.20 in /usr/local/lib/python3.12/dist-packages (from streamlit) (5.29.5)\n","Requirement already satisfied: pyarrow<22,>=7.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (18.1.0)\n","Requirement already satisfied: requests<3,>=2.27 in /usr/local/lib/python3.12/dist-packages (from streamlit) (2.32.4)\n","Requirement already satisfied: tenacity<10,>=8.1.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (8.5.0)\n","Requirement already satisfied: toml<2,>=0.10.1 in /usr/local/lib/python3.12/dist-packages (from streamlit) (0.10.2)\n","Requirement already satisfied: typing-extensions<5,>=4.4.0 in /usr/local/lib/python3.12/dist-packages (from streamlit) (4.15.0)\n","Requirement already satisfied: watchdog<7,>=2.1.5 in /usr/local/lib/python3.12/dist-packages (from streamlit) (6.0.0)\n","Requirement already satisfied: gitpython!=3.1.19,<4,>=3.0.7 in /usr/local/lib/python3.12/dist-packages (from streamlit) (3.1.45)\n","Requirement already satisfied: tornado!=6.5.0,<7,>=6.0.3 in /usr/local/lib/python3.12/dist-packages (from streamlit) (6.5.1)\n","Requirement already satisfied: jinja2>=2.10.1 in /usr/local/lib/python3.12/dist-packages (from pydeck) (3.1.6)\n","Requirement already satisfied: jsonschema>=3.0 in /usr/local/lib/python3.12/dist-packages (from altair!=5.4.0,!=5.4.1,<6,>=4.0->streamlit) (4.25.1)\n","Requirement already satisfied: narwhals>=1.14.2 in /usr/local/lib/python3.12/dist-packages (from altair!=5.4.0,!=5.4.1,<6,>=4.0->streamlit) (2.10.0)\n","Requirement already satisfied: gitdb<5,>=4.0.1 in /usr/local/lib/python3.12/dist-packages (from gitpython!=3.1.19,<4,>=3.0.7->streamlit) (4.0.12)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.12/dist-packages (from jinja2>=2.10.1->pydeck) (3.0.3)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.12/dist-packages (from pandas<3,>=1.4.0->streamlit) (2.9.0.post0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.12/dist-packages (from pandas<3,>=1.4.0->streamlit) (2025.2)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.12/dist-packages (from pandas<3,>=1.4.0->streamlit) (2025.2)\n","Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.27->streamlit) (3.4.4)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.27->streamlit) (3.11)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.27->streamlit) (2.5.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.27->streamlit) (2025.10.5)\n","Requirement already satisfied: smmap<6,>=3.0.1 in /usr/local/lib/python3.12/dist-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.19,<4,>=3.0.7->streamlit) (5.0.2)\n","Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.12/dist-packages (from jsonschema>=3.0->altair!=5.4.0,!=5.4.1,<6,>=4.0->streamlit) (25.4.0)\n","Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.12/dist-packages (from jsonschema>=3.0->altair!=5.4.0,!=5.4.1,<6,>=4.0->streamlit) (2025.9.1)\n","Requirement already satisfied: referencing>=0.28.4 in /usr/local/lib/python3.12/dist-packages (from jsonschema>=3.0->altair!=5.4.0,!=5.4.1,<6,>=4.0->streamlit) (0.37.0)\n","Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.12/dist-packages (from jsonschema>=3.0->altair!=5.4.0,!=5.4.1,<6,>=4.0->streamlit) (0.28.0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.12/dist-packages (from python-dateutil>=2.8.2->pandas<3,>=1.4.0->streamlit) (1.17.0)\n","Downloading streamlit-1.51.0-py3-none-any.whl (10.2 MB)\n","\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m10.2/10.2 MB\u001b[0m \u001b[31m91.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading pydeck-0.9.1-py2.py3-none-any.whl (6.9 MB)\n","\u001b[2K   \u001b[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\u001b[0m \u001b[32m6.9/6.9 MB\u001b[0m \u001b[31m91.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: pydeck, streamlit\n","Successfully installed pydeck-0.9.1 streamlit-1.51.0\n"]}],"source":["!pip install streamlit pydeck"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":106},"executionInfo":{"elapsed":55,"status":"error","timestamp":1762152417874,"user":{"displayName":"bakhoya","userId":"02952077666305694402"},"user_tz":-180},"id":"e176b962","outputId":"3fb6dc86-c6f1-43f2-a34c-5b7a4486057b"},"outputs":[{"ename":"SyntaxError","evalue":"incomplete input (ipython-input-3128175238.py, line 2)","output_type":"error","traceback":["\u001b[0;36m  File \u001b[0;32m\"/tmp/ipython-input-3128175238.py\"\u001b[0;36m, line \u001b[0;32m2\u001b[0m\n\u001b[0;31m    streamlit_code = \"\"\"\u001b[0m\n\u001b[0m                     ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m incomplete input\n"]}],"source":["# Save the Streamlit code to a file\n","streamlit_code = \"\"\"\n","# dashboard.py\n","# Wajir County Climate & Conflict Early Warning Dashboard\n","import streamlit as st\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import plotly.express as px\n","import joblib\n","import numpy as np\n","import os\n","import pydeck as pdk # Import pydeck for spatial mapping\n","\n","st.set_page_config(page_title=\"Wajir Climate & Conflict Early Warning\", layout=\"wide\")\n","st.title(\"üåç Wajir County Climate & Conflict Early Warning Dashboard\")\n","st.markdown(\"Upload or place `Wajir_NDVI_Rainfall_2015_2024.csv` and a trained `wajir_prediction_model.pkl` in this folder. The dashboard will visualize trends and let you run predictions using the uploaded model.\")\n","\n","# -------- Load dataset (CSV) ----------\n","DATA_FILENAME = \"Wajir_NDVI_Rainfall_2015_2024.csv\"\n","if os.path.exists(DATA_FILENAME):\n","    df = pd.read_csv(DATA_FILENAME)\n","    df = df.fillna(method='ffill')\n","    st.success(f\"‚úÖ Loaded dataset: {DATA_FILENAME} ({len(df)} rows)\")\n","\n","    # -------- Sidebar quick stats ----------\n","    with st.sidebar:\n","        st.header(\"Dataset summary\")\n","        st.write(f\"Records: {len(df)}\")\n","        st.write(f\"Years: {int(df['year'].min())} - {int(df['year'].max())}\")\n","        st.write(f\"Avg NDVI: {df['ndvi'].mean():.2f}\")\n","        st.write(f\"Avg Rainfall (mm): {df['rainfall'].mean():.2f}\")\n","        st.markdown(\"---\")\n","        st.write(\"Model upload (optional)\")\n","\n","    # -------- Model upload / load ----------\n","    MODEL_FILENAME = \"wajir_prediction_model.pkl\"\n","    model = None\n","    model_loaded_from = None\n","\n","    # If model file exists in folder, load it\n","    if os.path.exists(MODEL_FILENAME):\n","        try:\n","            model = joblib.load(MODEL_FILENAME)\n","            model_loaded_from = f\"disk:{MODEL_FILENAME}\"\n","            st.sidebar.success(f\"Loaded model from `{MODEL_FILENAME}`\")\n","        except Exception as e:\n","            st.sideba\n","\n","with open(\"dashboard.py\", \"w\") as f:\n","    f.write(streamlit_code)\n","\n","print(\"Streamlit code saved to dashboard.py\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"e066782e","outputId":"42fa67af-e68b-4e4c-f2b2-000204cecabc"},"outputs":[{"name":"stdout","output_type":"stream","text":["Usage: streamlit run [OPTIONS] [TARGET] [ARGS]...\n","Try 'streamlit run --help' for help.\n","\n","Error: Invalid value: File does not exist: dashboard.py\n","\u001b[1G\u001b[0K‚†ô\u001b[1G\u001b[0K‚†π\u001b[1G\u001b[0K‚†∏\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K‚†¥\u001b[1G\u001b[0K‚†¶\u001b[1G\u001b[0K‚†ß\u001b[1G\u001b[0K‚†á\u001b[1G\u001b[0K‚†è\u001b[1G\u001b[0K‚†ã\u001b[1G\u001b[0K‚†ô\u001b[1G\u001b[0K‚†π\u001b[1G\u001b[0K‚†∏\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K‚†¥\u001b[1G\u001b[0K‚†¶\u001b[1G\u001b[0K‚†ß\u001b[1G\u001b[0K‚†á\u001b[1G\u001b[0K‚†è\u001b[1G\u001b[0K‚†ã\u001b[1G\u001b[0K‚†ô\u001b[1G\u001b[0K‚†π\u001b[1G\u001b[0K‚†∏\u001b[1G\u001b[0K‚†º\u001b[1G\u001b[0K‚†¥\u001b[1G\u001b[0K‚†¶\u001b[1G\u001b[0K\u001b[1G\u001b[0JNeed to install the following packages:\n","localtunnel@2.0.2\n","Ok to proceed? (y) \u001b[20G"]}],"source":["!streamlit run dashboard.py & npx localtunnel --port 8501"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1592,"status":"ok","timestamp":1762152131140,"user":{"displayName":"bakhoya","userId":"02952077666305694402"},"user_tz":-180},"id":"e4637819","outputId":"ee2141f4-bfbd-4284-8fa2-b5374240fdd4"},"outputs":[{"name":"stdout","output_type":"stream","text":["Model trained and saved successfully as 'wajir_prediction_model.pkl'\n"]}],"source":["from sklearn.linear_model import LinearRegression\n","import joblib\n","\n","# Prepare data for training\n","# We will use 'rainfall' and 'month' to predict 'ndvi'\n","X = df[['rainfall', 'month']]\n","y = df['ndvi']\n","\n","# Train a simple Linear Regression model\n","model = LinearRegression()\n","model.fit(X, y)\n","\n","# Save the trained model\n","joblib.dump(model, 'wajir_prediction_model.pkl')\n","\n","print(\"Model trained and saved successfully as 'wajir_prediction_model.pkl'\")"]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyOPpyZcXYVReNvtmGIgATaG"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}